{% extends 'new_home.html' %}
{% load static %}

{% block head_js_css %}
{% endblock %}

{% block body %}
<div class="container passwordreset">
<div class="row">
  <div class="col-lg-2 col-md-2 col-sm-2">
  </div>
  <div class=" col-lg-8 col-md-8 col-sm-8">
    <div class="row"><h4 class="text-center">Select the way you want to receive the activation link -</h4></div>
    <form role="form" action="{{ request.get_full_path }}" method="post" id="passwordresetform">
    {% csrf_token %}
      <div class="form-group">
      <div class="row" style="margin-top: 40px;margin-bottom: 40px;">
      <div class="col-lg-3 col-md-3 col-sm-3"></div>
      <div class="col-lg-3 col-md-3 col-sm-3">
      <label class="radio-inline">
      <input type="radio" id="emailoption" name="option" value="emailoption" checked><label for="emailoption">Email</label>
      </label>
      </div>
      <div class="col-lg-3 col-md-3 col-sm-3">
      <label class="radio-inline">
      <input type="radio" id="mobileoption" name="option" value="mobileoption"><label for="mobileoption">Mobile</label>
      </label>
      </div>
      <div class="col-lg-3 col-md-3 col-sm-3"></div>
      </div>
      </div>
      <div class="form-group">
      <input class="form-control sharp" name="email" id="email" type="email" placeholder="Type your email here..." autocomplete="off">
      <input name="phone_number" id="phone_number" type="text" class="form-control" placeholder="Type your phone number here..." autocomplete="off" maxlength="10" style="display:none;">
      </div>
      <div class="form-group">
      <button type="submit" class="btn btn-primary btn-block sharp">Submit</button>
      </div>
    </form>
  </div>
  <div class="col-lg-2 col-md-2 col-sm-2">
  </div>
</div>
</div>
  </div>
{% endblock %}

{% block footer_css_js %}
<script>
$('input[type="radio"]').click(function(e) {
  var type_selected = e.target.id;
  if(type_selected === 'mobileoption'){
    $('#email').css('display','none');
    $('#phone_number').css('display','inline-block');
  }
  if(type_selected === 'emailoption'){
    $('#email').css('display','inline-block');
    $('#phone_number').css('display','none');
  }
});

$(function () {
  $.validator.addMethod('phoneUK', function(phone_number, element) {
                    var pattern = /^([789]\d{9})$/;
                    return pattern.test(phone_number)
                    }, 'Phone number must be in Indian format.');

        $("#passwordresetform").validate(
                {
                    rules: {
                        email: {
                            required: true,
                            remote:'/db_email/'
                        },
                        phone_number: {
                            required: true,
                            remote:'/verify_phone_number/',
                            phoneUK: true
                        }
                    },
                    errorElement: 'p',
                highlight: function(element) {
                    $(element).parent().addClass("has-error");
                    $(element).addClass('error')
                },
                unhighlight: function(element) {
                    $(element).parent().removeClass("has-error");
                    $(element).removeClass('error')
                },
                    messages: {
                        email: {
                            required: "Please enter your email.",
                            remote: 'This email does not exist with CLAT.'
                        },
                        phone_number: {
                        required :  "Please enter phone number.",
                        phoneUK  : "Phone number must be in Indian format.", 
                        remote : "This phone number does not exist with CLAT.",
                        }
                    }
                });

    });

</script>
{%endblock%}
